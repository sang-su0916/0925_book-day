# 📊 새 스프레드시트 생성 및 연결 가이드

## 🎯 문제 해결 방법

현재 스프레드시트 권한 문제를 해결하기 위해 **새로운 스프레드시트를 Apps Script에서 직접 생성**하는 방법을 사용합니다.

## 🚀 단계별 진행

### 1단계: Google Apps Script에서 새 스프레드시트 생성

다음 코드를 Google Apps Script 에디터에서 실행하세요:

```javascript
function createNewSpreadsheet() {
  try {
    // 새 스프레드시트 생성
    const spreadsheet = SpreadsheetApp.create('회원의날_신청자_DB');
    const spreadsheetId = spreadsheet.getId();

    console.log('✅ 새 스프레드시트 생성 완료');
    console.log('📋 스프레드시트 ID:', spreadsheetId);
    console.log('🔗 URL:', `https://docs.google.com/spreadsheets/d/${spreadsheetId}`);

    // 첫 번째 시트 설정
    const sheet = spreadsheet.getSheets()[0];
    sheet.setName('회원의날_신청자');

    // 헤더 설정
    const headers = ['신청일시', '이름', '연락처', '이메일', '행사명', '상태', 'IP주소'];
    const headerRange = sheet.getRange(1, 1, 1, headers.length);
    headerRange.setValues([headers]);

    // 헤더 스타일링
    headerRange.setBackground('#4285f4')
               .setFontColor('white')
               .setFontWeight('bold')
               .setHorizontalAlignment('center');

    // 컬럼 너비 조정
    sheet.setColumnWidth(1, 150); // 신청일시
    sheet.setColumnWidth(2, 100); // 이름
    sheet.setColumnWidth(3, 130); // 연락처
    sheet.setColumnWidth(4, 200); // 이메일
    sheet.setColumnWidth(5, 250); // 행사명
    sheet.setColumnWidth(6, 80);  // 상태
    sheet.setColumnWidth(7, 120); // IP주소

    // 테스트 데이터 추가
    const testData = [
      new Date().toLocaleString('ko-KR'),
      '시스템테스트',
      '010-1234-5678',
      'test@example.com',
      '회원의 날(실전 프롬프트 비법 공개와 책소개)',
      '테스트완료',
      '127.0.0.1'
    ];

    sheet.appendRow(testData);
    console.log('✅ 테스트 데이터 추가 완료');

    return {
      status: 'success',
      spreadsheetId: spreadsheetId,
      url: `https://docs.google.com/spreadsheets/d/${spreadsheetId}`,
      message: '새 스프레드시트 생성 및 설정 완료'
    };

  } catch (error) {
    console.error('❌ 스프레드시트 생성 실패:', error);
    return {
      status: 'error',
      message: error.toString()
    };
  }
}
```

### 2단계: 실행 후 새 ID 복사

1. Google Apps Script에서 위 함수 실행
2. 실행 로그에서 새로운 **스프레드시트 ID** 복사
3. 자동으로 생성된 스프레드시트는 Apps Script와 완벽하게 연결됨

### 3단계: CONFIG 업데이트

새로 생성된 스프레드시트 ID로 CONFIG를 업데이트합니다.

## ✅ 장점

1. **완벽한 권한**: Apps Script가 생성한 스프레드시트는 자동으로 모든 권한을 가짐
2. **즉시 작동**: 별도의 공유 설정 불필요
3. **깔끔한 시작**: 처음부터 올바른 헤더와 스타일로 설정

## 🎯 다음 단계

새 스프레드시트 ID를 받으면:
1. Google_Apps_Script.js의 CONFIG.spreadsheetId 업데이트
2. 웹앱 재배포
3. 전체 시스템 테스트

**이 방법이 가장 확실하고 빠른 해결책입니다!** 🚀